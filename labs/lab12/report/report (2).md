

Лабораторная работа н.12

Программирование в командном процессоре ОС UNIX. Расширенное

программирование

Петров Артем Евгеньевич





Содержание

[Цель](#br4)[ ](#br4)[работы](#br4)

[Задание](#br5)

4

5

[Выполнение](#br7)[ ](#br7)[лабораторной](#br7)[ ](#br7)[работы](#br7)

7

7

8

9

[Задание](#br7)[ ](#br7)[1.](#br7)[ ](#br7)[Рис.](#br7)[ ](#br7)[\[-@ﬁg:001\].](#br7)[ ](#br7). . . . . . . . . . . . . . . . . . . . . . . . . . . .

[Задание](#br8)[ ](#br8)[2.](#br8)[ ](#br8)[Рис.](#br8)[ ](#br8)[\[-@ﬁg:002\]-\[-@ﬁg:003\].](#br8)[ ](#br8). . . . . . . . . . . . . . . . . . . . . .

[Задание](#br9)[ ](#br9)[3.](#br9)[ ](#br9)[Рис.](#br9)[ ](#br9)[\[-@ﬁg:004\].](#br9)[ ](#br9). . . . . . . . . . . . . . . . . . . . . . . . . . . .

[Выводы](#br11)

11

12

[Контрольные](#br12)[ ](#br12)[вопросы](#br12)

2





Список иллюстраций

[0.1](#br7)[ ](#br7)[Название](#br7)[ ](#br7)[рисунка](#br7)[ ](#br7). . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

[0.2](#br8)[ ](#br8)[1.](#br8)[ ](#br8)[Выполнение](#br8)[ ](#br8)[скрипта](#br8)[ ](#br8)[н.1](#br8)[ ](#br8). . . . . . . . . . . . . . . . . . . . . . . . .

[0.3](#br9)[ ](#br9)[2.](#br9)[ ](#br9)[Выполнение](#br9)[ ](#br9)[скрипта](#br9)[ ](#br9)[н.2](#br9)[ ](#br9). . . . . . . . . . . . . . . . . . . . . . . . .

[0.4](#br9)[ ](#br9)[3.Выполнение](#br9)[ ](#br9)[скрипта](#br9)[ ](#br9)[н.2](#br9)[ ](#br9). . . . . . . . . . . . . . . . . . . . . . . . .

7

8

9

9

[0.5](#br10)[ ](#br10)[4.Выполнение](#br10)[ ](#br10)[скрипта](#br10)[ ](#br10)[н.3](#br10)[ ](#br10). . . . . . . . . . . . . . . . . . . . . . . . . 10

3





Цель работы

Изучить основы программирования в оболочке ОС UNIX. Научиться писать более

сложные командные файлы с использованием логических управляющих конструкций

и циклов.

4





Задание

\1. Написать командный файл, реализующий упрощённый механизм семафо-

ров. Ко- мандный файл должен в течение некоторого времени t1 дожидаться

освобождения ресурса, выдавая об этом сообщение, а дождавшись его освобож-

дения, использовать его в течение некоторого времени t2<>t1, также выдавая

информацию о том, что ресурс используется соответствующим командным

файлом (процессом). Запустить командный файл в одном виртуальном тер-

минале в фоновом режиме, перенаправив его вывод в другой (> /dev/tty#,

где # ꢀ номер терминала куда перенаправляется вывод), в котором также

запущен этот файл, но не фоновом, а в привилегированном режиме. Дорабо-

тать программу так, чтобы имелась возможность взаимодействия трёх и более

процессов.

\2. Реализовать команду man с помощью командного файла. Изучите содержимое

ката- лога /usr/share/man/man1. В нем находятся архивы текстовых файлов,

содержащих справку по большинству установленных в системе программ и

команд. Каждый архив можно открыть командой less сразу же просмотрев

содержимое справки. Командный файл должен получать в виде аргумента

командной строки название команды и в виде результата выдавать справку об

этой команде или сообщение об отсутствии справки, если соответствующего

файла нет в каталоге man1.

\3. Используя встроенную переменную $RANDOM, напишите командный файл,

генерирую- щий случайную последовательность букв латинского алфавита.

Учтите, что $RANDOM выдаёт псевдослучайные числа в диапазоне от 0 до

5





\32767.

6





Выполнение лабораторной работы

Описываются проведённые действия, в качестве иллюстрации даётся ссылка на

иллюстрацию (рис. [-@ﬁg:001])

Рис. 0.1: Название рисунка

Задание 1. Рис. [-@ﬁg:001].

#!/bin/bash

lockﬁle = "./lock.ﬁle"

exec {fn}>lockﬁle

7





echo 'locked'

until ﬂock -n ${fn}

do

echo "idk not wrkin"

sleep 1

ﬂick -n ${fn}

done

for ((i=0; i<=7; i++))

do

echo "it works"

sleep 1

done

Рис. 0.2: 1. Выполнение скрипта н.1

Задание 2. Рис. [-@ﬁg:002]-[-@ﬁg:003].

#!/bin/bash

cd /usr/share/man/man1

echo the command you need:

read command

less $command\*

8





Рис. 0.3: 2. Выполнение скрипта н.2

Рис. 0.4: 3.Выполнение скрипта н.2

Задание 3. Рис. [-@ﬁg:004].

#!/bin/bash

num

echo enter num of random stuﬀ:

read word

for((i=0;i<$word;i++))

do

echo $RANDOM | tr '[0-32670]' '[a-z]'

done

9





Рис. 0.5: 4.Выполнение скрипта н.3

10





Выводы

Благодаря данной лабораторной работе я научился создавать генератор случайных

последовательностей символов, написал упрощенный механизм семафоров и узнал,

как реализовать замену для базовых команды Unix

11





Контрольные вопросы

\1. Для правильного исполнения командной строки while [$1 != "exit"] квадратные

скобки нужно поменять на круглые скобки

\2. Использовать знак $ между двумя переменными символьного типа для оъеди-

нения нескольких строк в одно единую целую строку

\3. seq - выводит последовательность целых или действительных чисел для пере-

дачи в другие программы, на языке bash её можно реализовать с помощью

цикла for

\4. 10 / 3 = 3 (дробная часть будет отброшена, так как числа целые, но если бы

было 10.000/3.000 = 3.333)

\5. Zsh выполнен на основе bash, а поэтому наследует как недостатки так и пре-

имущества bash, но в zsh есть автодополнение, горячие клавишы, алиасы,

различные удобства в виде тем, плагинов и расширенной поддержке, однако

есть минус всей этой красоты и удобства, на узкоспециализированных маши-

нах это красоты быть не может в принципе из-за ограничений железа или

системного администратора

\6. Синтаксиси верен, однако для надежности лучше писать for и ((some words))

без пробела, т.е. слитно

12


